# Fail2Ban jail.local configuration
# Generated by Node Pulse Admiral
# {{ ansible_managed }}

[DEFAULT]

# Ban time in seconds ({{ bantime }}s = {{ (bantime / 60) | int }} minutes)
bantime = {{ bantime }}

# Time window to count failed attempts ({{ findtime }}s = {{ (findtime / 60) | int }} minutes)
findtime = {{ findtime }}

# Maximum number of failed attempts before banning
maxretry = {{ maxretry }}

# Destination email for notifications
destemail = {{ destemail }}

# Sender email
sendername = Fail2Ban

# Ban action to use (action_ = ban only, action_mw = ban + email, action_mwl = ban + email with logs)
action = {{ action }}

# Protocol (tcp, udp, icmp, all)
protocol = tcp

# Chain where jumps would need to be added in iptables-* actions
chain = INPUT

# Ports to ban (can be overridden per jail)
port = 0:65535

# Ban & log actions
banaction = iptables-multiport
banaction_allports = iptables-allports

# Log level (CRITICAL, ERROR, WARNING, NOTICE, INFO, DEBUG)
loglevel = INFO

# Log target (SYSLOG, STDERR, STDOUT, /path/to/file)
logtarget = /var/log/fail2ban.log

# Backend for log file monitoring (auto, polling, gamin, pyinotify, systemd)
backend = auto
