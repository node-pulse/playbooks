# Fail2Ban jail.local configuration
# Generated by Node Pulse Admiral
# {{ ansible_managed }}

[DEFAULT]

# Ban time in seconds ({{ bantime }}s = {{ (bantime / 60) | int }} minutes)
bantime = {{ bantime }}

# Time window to count failed attempts ({{ findtime }}s = {{ (findtime / 60) | int }} minutes)
findtime = {{ findtime }}

# Maximum number of failed attempts before banning
maxretry = {{ maxretry }}

{% if webhook_url != "" %}
# Ban action with webhook notifications
action = %(action_)s
         webhook
{% else %}
# Ban action (no notifications configured)
action = %(action_)s
{% endif %}

# Protocol (tcp, udp, icmp, all)
protocol = tcp

# Chain where jumps would need to be added in iptables-* actions
chain = INPUT

# Ports to ban (can be overridden per jail)
port = 0:65535

# Ban & log actions
banaction = iptables-multiport
banaction_allports = iptables-allports

# Log level (CRITICAL, ERROR, WARNING, NOTICE, INFO, DEBUG)
loglevel = INFO

# Log target (SYSLOG, STDERR, STDOUT, /path/to/file)
logtarget = /var/log/fail2ban.log

# Backend for log file monitoring (auto, polling, gamin, pyinotify, systemd)
backend = auto
